/**
 * @preserve jquery.layout.state 1.0
 * $Date: 2011-07-16 08:00:00 (Sat, 16 July 2011) $
 *
 * Copyright (c) 2010 
 *   Kevin Dalman (http://allpro.net)
 *
 * Dual licensed under the GPL (http://www.gnu.org/licenses/gpl.html)
 * and MIT (http://www.opensource.org/licenses/mit-license.php) licenses.
 *
 * @dependancies: UI Layout 1.3.0.rc30.1 or higher
 * @dependancies: $.ui.cookie (above)
 *
 * @support: http://groups.google.com/group/jquery-ui-layout
 */
!function(e){e.layout&&(e.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(t){for(var a,o=document.cookie,n=o?o.split(";"):[],i=0,s=n.length;s>i;i++)if(a=e.trim(n[i]).split("="),a[0]==t)return decodeURIComponent(a[1]);return""},write:function(e,t,a){var o="",n="",i=!1,s=a||{};s.expires&&(s.expires.toUTCString?n=s.expires:"number"==typeof s.expires&&(n=new Date,s.expires>0?n.setDate(n.getDate()+s.expires):(n.setYear(1970),i=!0))),n&&(o+=";expires="+n.toUTCString()),s.path&&(o+=";path="+s.path),s.domain&&(o+=";domain="+s.domain),s.secure&&(o+=";secure"),document.cookie=e+"="+(i?"":encodeURIComponent(t))+o},clear:function(t){e.ui.cookie.write(t,"",{expires:-1})}},e.layout.plugins.stateManagement=!0,e.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}},e.layout.optionsMap.layout.push("stateManagement"),e.layout.state={config:{allPanes:"north,south,west,east,center"},saveCookie:function(t,a,o){var n=t.options,i=n.stateManagement,s=e.extend({},i.cookie,o||{}),r=t.state.stateData=t.readState(a||i.stateKeys);return e.ui.cookie.write(s.name||n.name||"Layout",e.layout.state.encodeJSON(r),s),e.extend({},r)},deleteCookie:function(t){var a=t.options;e.ui.cookie.clear(a.stateManagement.cookie.name||a.name||"Layout")},readCookie:function(t){var a=t.options,o=e.ui.cookie.read(a.stateManagement.cookie.name||a.name||"Layout");return o?e.layout.state.decodeJSON(o):{}},loadCookie:function(t){var a=e.layout.state.readCookie(t);return a&&!e.isEmptyObject(a)&&(t.state.stateData=e.extend({},a),t.loadState(a)),a},loadState:function(t,o,n){if(o=e.layout.transformData(o),e.extend(!0,t.options,o),t.state.initialized){var i,s,r,u,d=n===!1;e.each(e.layout.state.config.allPanes.split(","),function(e,n){i=o[n],"object"==typeof i&&(s=i.size,u=i.initClosed,r=i.initHidden,(s>0||"auto"==s)&&t.sizePane(n,s,!1,null,d),r===!0?t.hide(n,a):u===!1?t.open(n,!1,d):u===!0?t.close(n,!1,d):r===!1&&t.show(n,!1,d))})}},readState:function(t,a){var o,n,i,s,r={},u={isClosed:"initClosed",isHidden:"initHidden"},d=t.state;a||(a=t.options.stateManagement.stateKeys),e.isArray(a)&&(a=a.join(",")),a=a.replace(/__/g,".").split(",");for(var l=0,c=a.length;c>l;l++)o=a[l].split("."),n=o[0],i=o[1],e.layout.state.config.allPanes.indexOf(n)<0||(s=d[n][i],void 0!=s&&("isClosed"==i&&d[n].isSliding&&(s=!0),(r[n]||(r[n]={}))[u[i]?u[i]:i]=s));return r},encodeJSON:function(e){function t(e){var t,a,o,n=[],i=0;for(t in e)a=e[t],o=typeof a,"string"==o?a='"'+a+'"':"object"==o&&(a=parse(a)),n[i++]='"'+t+'":'+a;return"{"+n.join(",")+"}"}var a=window.JSON||{};return(a.stringify||t)(e)},decodeJSON:function(t){try{return e.parseJSON?e.parseJSON(t):window.eval("("+t+")")||{}}catch(a){return{}}},_create:function(t){e.extend(t,{readCookie:function(){return e.layout.state.readCookie(t)},deleteCookie:function(){e.layout.state.deleteCookie(t)},saveCookie:function(a,o){return e.layout.state.saveCookie(t,a,o)},loadCookie:function(){return e.layout.state.loadCookie(t)},loadState:function(a,o){e.layout.state.loadState(t,a,o)},readState:function(a){return e.layout.state.readState(t,a)},encodeJSON:e.layout.state.encodeJSON,decodeJSON:e.layout.state.decodeJSON}),t.state.stateData={};var a=t.options.stateManagement;a.enabled&&(a.autoLoad?t.loadCookie():t.state.stateData=t.readCookie())},_unload:function(e){var t=e.options.stateManagement;t.enabled&&(t.autoSave?e.saveCookie():e.state.stateData=e.readState())}},e.layout.onCreate.push(e.layout.state._create),e.layout.onUnload.push(e.layout.state._unload))}(jQuery);